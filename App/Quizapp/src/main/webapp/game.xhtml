<?xml version='1.0' encoding='UTF-8'?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <title>Quiz</title>
        <f:metadata>
            <f:viewAction action="#{checkerController.checkGameAndUser()}" />
        </f:metadata>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
    </h:head>
    <h:body>
        <h2>Quiz</h2>
        <p><h:outputText value="#{currentGame.getGame().getQuiz().getCategory().getCategory()}"/></p>
        <h:form id="quizForm">
            <h:outputText value="Frage: #{quizController.question.question}" />

            <ui:repeat value="#{quizController.answers}" var="answer">
                <h:commandButton value="#{answer.answer}" action="#{quizController.validateAnswer(answer)}" />
            </ui:repeat>

            <h:outputText value="Frage #{quizController.index + 1} von #{quizController.maxIndex + 1}" />

            <h:panelGroup rendered="#{quizController.submittedAnswers == 10}">
                <h:commandButton value="Quiz beenden" action="#{quizController.endGame}" />
            </h:panelGroup>

            <h:outputText value="Aktueller Punktestand: #{quizController.score}" />

            <h:panelGroup id="reportPanel">
                <h:commandButton value="Frage melden" action="#{quizController.setReportCurrentQuestion(true)}" rendered="#{!quizController.reportCurrentQuestion}">
                    <f:ajax render="reportPanel" />
                </h:commandButton>

                <h:panelGroup rendered="#{quizController.reportCurrentQuestion}">
                    <h:selectOneMenu value="#{quizController.message}">
                        <f:selectItem itemLabel="Bitte wählen..." itemValue="" />
                        <f:selectItem itemLabel="Keine richtige Antwortmöglichkeit vorhanden" itemValue="Keine richtige Antwortmöglichkeit vorhanden" />
                        <f:selectItem itemLabel="Frage ist unverständlich formuliert" itemValue="Frage ist unverständlich formuliert" />
                        <f:selectItem itemLabel="Es ist ein Rechtschreibfehler vorhanden" itemValue="Es ist ein Rechtschreibfehler vorhanden" />
                        <f:ajax render="reportPanel" />
                    </h:selectOneMenu>

                    <h:panelGroup rendered="#{not empty quizController.message}">
                        <h:commandButton value="Meldung abschicken" action="#{quizController.reportQuestion}">
                            <f:ajax render="@form reportPanel" />
                        </h:commandButton>
                    </h:panelGroup>
                </h:panelGroup>
            </h:panelGroup>
            <h:messages for="quizForm" layout="table" />
        </h:form>

        <!-- Bootstrap JavaScript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    </h:body>
</html>